{
    "id": "http://standard.zindex.cz/doku.php/cs/schema/release-schema_v1.json",
    "$schema": "http://json-schema.org/draft-04/schema#", 
    "$schemaODC": "http://ocds.open-contracting.org/standard/r/1__0__RC/release-schema.json",
    "title": "Definice datové struktury smluv",
    "type": "object",
    
    "properties": {
        "id": {
            "title": "Release ID",
            "description": "Jednoznačný identifikátor tohoto souboru",
            "type": "string"
        },
        "date": {
            "title": "Release date",
            "description": "Datum publikace souboru",
            "type": "string",
            "format": "date-time"
        },  
        
        "documents": {
            "title": "Documents",
            "description": "Seznam dokumentů",
            "type": "array",
            "items": {  
              "anyOf": [
                { "allOf": [
                    { "$ref": "#/definitions/Document" },
                    { "$ref": "#/definitions/Contract" }
                  ]
                },
                {
                  "allOf": [
                    { "$ref": "#/definitions/Document" },
                    { "$ref": "#/definitions/Attachment" }
                  ]
                },
                {
                  "allOf": [
                    { "$ref": "#/definitions/Document" },
                    { "$ref": "#/definitions/Amendment" }
                  ]  
                }
              ]
            }
        },  
          
        "orders": {
            "title": "Orders",
            "description": "Seznam objednávek",
            "type": "array",
            "items": { "$ref": "#/definitions/Order" },
            "uniqueItems": true
        },  
        
        "invoices": {
            "title": "Invoices",
            "description": "Seznam faktur",
            "type": "array",
            "items": { "$ref": "#/definitions/Invoice" },
            "uniqueItems": true
        },     
        
        "language": {
            "title": "Release language",
            "description": "Specifikace jazyka pro data. Doporučuje se použití dvou znakového ISO 639-1",
            "type": ["string", "null"],
            "default": "cs"
        }
    },
    
    "required": ["id", "date", "documents" ,"language"],
    
    "definitions": {
        
        "Document": {
            "type": "object",
            "title": "Document",
            "description": "Dokument je základní strukturou pro evidování údajů o smlouvách.",
            "properties": {          
                "uri": {
                    "description": "Jednoznačný identifikátor formou URL. Typicky rsmluv.cz/[Typ]/[Id]/[Version], kde Version je vzestupné číslování verzí při změnách dokumentu či metadat",
                    "type": ["string", "null"],
                    "format": "uri",
                    "validity": "S"
                },
                "document": {
                    "description": "Adresa URL fyzického umístění dokumentu. Typicky rsmluv.cz/[Typ]/[Id]/[Version]/File",
                    "type": ["string", "null"],
                    "format": "uri",
                    "validity": "S"
                },
                "versions": {
                    "description": "Údaje o verzi dokumentu.",
                    "type": "array",
                    "items": { "$ref": "#/definitions/Version" },
                    "validity": "S"
                },
                "type": {
                    "description": "Typ dokumentu. Nabývá hodnot - Smlouva/Příloha/Dodatek",
                    "type": "array",
                    "items": {
                        "type": "string"
                    },
                    "validity": "C"
                },  
                "publisher": {
                    "description": "Informace o vydavateli.",
                    "$ref": "#/definitions/Publisher",
                    "validity": "C"
                },
                "valid": {
                    "description": "Indikuje, zda dokument je platný, tj. nebyl zneplatněn nebo nahrazen novou verzí",
                    "type": ["boolean", "null"],
                    "validity": ["B", "S"]
                },
                "plainText": {
                    "description": "Prostý text dokumentu (nestrukturovaný, indexovatelný), alternativa pro scanované dokumenty",
                    "type": ["string", "null"],
                    "validity": ["B", "S"]
                },
                "responsiblePersons": {
                    "description": "Výčet odpovědných osob",
                    "type": ["array", "null"],
                    "items": {
                        "type": "string"
                    },
                    "validity": "B"
                },
                "anonymised": {
                    "description": "Značí, zda-li byla provedena anonymizace dokumentu",
                    "type": ["boolean", "null"],
                    "validity": "B"
                }       
            },
            "patternProperties": {
            },
            "required": ["type", "publisher"]
        },    
        
        "Publisher": {
            "type": "object",
            "title": "Publisher",
            "description": "Informace o vydavateli, který zveřejňuje údaje o smlouvách.",
            "properties": {          
                "id": {
                    "description": "Identifikační číslo osoby, lze vložit i zahraniční ID",
                    "type": ["string", "null"],
                    "validity": "N"
                },
                "name": {
                    "description": "Název, případně jméno a příjmení (s tituly)",
                    "type": ["string", "null"],
                    "validity": "C"
                },
                "noID": {
                    "description": "Indikuje že subjekt nemá IČO, nebo zahraniční ID",
                    "type": ["boolean", "null"],
                    "validity": "B"
                },
                "country": {
                    "description": "Země původu, 3-písmený ISO kód",
                    "type": ["string", "null"],
                    "validity": "B"
                },
                "authentication": {
                    "description": "Značí stupeň ověřenosti zveřejňující strany.",
                    "type": ["string", "null"],
                    "validity": "S"
                }            
            },
            "patternProperties": {
            },
            "required": ["name"]
        },    
        
        "Party": {
            "type": "object",
            "title": "Party",
            "description": "Údaje o konkrétní smluvní straně vystupující ve smlouvě.",
            "properties": {          
                "id": {
                    "description": "Identifikační číslo osoby, lze vložit i zahraniční id",
                    "type": ["string", "null"],
                    "validity": "N"
                },
                "localID": {
                    "description": "Jednoznačný identifikátor v rámci dokumentu",
                    "type": ["integer", "null"],
                    "validity": "C"
                },
                "name": {
                    "description": "Název, případně jméno a příjmení (s tituly)",
                    "type": ["string", "null"],
                    "validity": "C"
                },
                "payer": {
                    "description": "Identifikuje stranu která bude finančně plnit, pokud není zřejmé, nevyplňuje se",
                    "type": ["boolean", "null"],
                    "validity": "C"
                },
                "noID": {
                    "description": "Indikuje že subjekt nemá IČO, nebo zahraniční ID",
                    "type": ["boolean", "null"],
                    "validity": "B"
                },
                "country": {
                    "description": "Země původu, 3-písmený ISO kód",
                    "type": ["string", "null"],
                    "validity": "B"
                },
                "address": {
                    "description": "Adresa subjektu, případně “Anonymizováno”",
                    "type": ["string", "null"],
                    "validity": "A"
                },
                "competency": {
                    "description": "Indikuje, zda-li se jedná o soukromoprávní nebo veřejnoprávní smlouvu",
                    "type": "array",
                    "items": {
                        "type": "string"
                    },
                    "validity": "S"
                },
                "paysVAT": {
                    "description": "Indikuje, zda-li je subjekt plátce DPH",
                    "type": "boolean",
                    "validity": "S"
                },
                "superiorInstitution": {
                    "description": "Řídící nebo ovládající právnická osoba, v případě veřejnoprávních smluv nadřízený správní orgán",
                    "$ref": "#/definitions/SuperiorInstitution",
                    "validity": "S"
                }            
            },
            "patternProperties": {
            },
            "required": ["localID", "name", "payer"]
        }, 
        
        "SuperiorInstitution": {
            "type": "object",
            "title": "SuperiorInstitution",
            "description": "Informace o řídící nebo ovládající právní osobě vystupující u smluvní strany. V případě veřejnoprávních smluv nadřízený správní orgán.",
            "properties": {          
                "id": {
                    "description": "Identifikační číslo osoby, lze vložit i zahraniční id",
                    "type": ["string", "null"],
                    "validity": "N"
                },
                "localID": {
                    "description": "Jednoznačný identifikátor v rámci dokumentu",
                    "type": ["integer", "null"],
                    "validity": "C"
                },
                "name": {
                    "description": "Název, případně jméno a příjmení (s tituly)",
                    "type": ["string", "null"],
                    "validity": "C"
                },
                "noID": {
                    "description": "Indikuje že subjekt nemá IČO, nebo zahraniční ID",
                    "type": ["boolean", "null"],
                    "validity": "B"
                },
                "country": {
                    "description": "Země původu, 3-písmený ISO kód",
                    "type": ["string", "null"],
                    "validity": "B"
                }         
            },
            "patternProperties": {
            },
            "required": ["localID", "name"]
        },  
        
        "Version": {
            "type": "object",
            "title": "Version",
            "description": "Identifikace jednotlivé verze dokumentu.",
            "properties": {          
                "version": {
                    "description": "Pořadové číslo verze, nejvyšší = aktuální",
                    "type": ["integer", "null"],
                    "validity": "S"
                },
                "uri": {
                    "description": "Identifikátor dané verze",
                    "type": ["string", "null"],
                    "format": "uri",
                    "validity": "S"
                },
                "published": {
                    "description": "Identifikátor dané verze",
                    "type": ["string", "null"],
                    "format": "date-time",
                    "validity": "S"
                }        
            },
            "patternProperties": {
            }
        },    
        
        "Contract": {
            "type": "object",
            "title": "Contract",
            "description": "Detailní popisné údaje smlouvy.",
            "properties": {    
                "awardID": {
                    "description": "Evidenční číslo veřejné zakázky. Uvádí se volitelně, pokud existuje.",
                    "type": ["string", "null"],
                    "validity": "N"
                },
                "awardProfileID": {
                    "description": "Číslo zakázky na profilu zadavatele",
                    "type": ["string", "null"],
                    "validity": "N"
                },   
                "ammount": {
                    "description": "Cena s DPH (u neplátců celková cena). Nejvyšší přípustná hodnota řádného plnění z dané smlouvy, které vynaloží některá smluvní strana. U smluv na dobu určitou se jedná o očekávané celkové finanční plnění strany s nejvyšším plněním, včetně opcí, bez sankcí. U smluv na dobu neurčitou, ve kterých není stanoven strop na celkové plnění, se jedná o nejvyšší očekávané roční plnění. U smluv bez finančního plnění (bartery, darovací smlouvy) je uvedena celková hodnota nefinančního plnění strany s nejvyšším plněním (např. odhadovaná hodnota daru). U smluv s nejasným plněním připustit NULL. Pokud je cena nenulová, tak alespoň jedna Party musí mít příznak Payer = true.",
                    "type": ["number", "null"],
                    "validity": "C"
                }, 
                "ammountNoVat": {
                    "description": "Cena bez dph, uvádí se povinně pouze v případě, že Ammount je s DPH",
                    "type": ["number", "null"],
                    "validity": "C"
                }, 
                "title": {
                    "description": "Předmět smlouvy",
                    "type": ["string", "null"],
                    "validity": "C"
                }, 
                "contractType": {
                    "description": "Číselník typů smlouvy.",
                    "type": ["string", "null"],
                    "validity": "C"
                },
                "parties": {
                    "description": "Výčet smluvních stran.",
                    "type": "array",
                    "items": { "$ref": "#/definitions/Party" },
                    "validity": "C"
                },
                "subjectType": {
                    "description": "Číselník typů zboží/služeb",
                    "type": ["string", "null"],
                    "validity": "B"
                },  
                "priceAnnual": {
                    "description": "Identifikuje, pokud je v Ammount roční částka.",
                    "type": ["boolean", "null"],
                    "validity": "B"
                },
                "currency": {
                    "description": "Měna, 3-písmenný, ISO 4217 formát",
                    "type": ["string", "null"],
                    "validity": "B"
                },
                "dateSigned": {
                    "description": "Datum posledního podpisu",
                    "type": ["string", "null"],
                    "format": "date",
                    "validity": "B"
                 },
                "validFrom": {
                    "description": "Datum účinnosti smlouvy",
                    "type": ["string", "null"],
                    "format": "date",
                    "validity": "B"
                },
                "validUntil": {
                    "description": "Datum ukončení účinnosti smlouvy (poslední plnění), NULL pro smlouvy na dobu .",
                    "type": ["string", "null"],
                    "format": "date",
                    "validity": "B"
                },
                "funding": {
                    "description": "Převažující financování – vlastní, případně název dotačního titulu (bude kontrolován proti číselníku)",
                    "type": ["string", "null"],
                    "validity": "B"
                },
                "annexes": {
                    "description": "Seznam URI identifikátorů příloh",
                    "type": ["array", "null"],
                    "items": {
                        "type": "string",
                        "format": "uri"
                    },
                    "validity": "B"
                },
                "supplements": {
                    "description": "Seznam URI identifikátorů dodatků",
                    "type": ["array", "null"],
                    "items": {
                        "type": "string",
                        "format": "uri"
                    },
                    "validity": "B"
                }, 
                "currentValidContract": {
                    "description": "Aktuálně platné znění smlouvy (se zapracovanými dodatky)",
                    "type": ["string", "null"],
                    "format": "uri",
                    "validity": "A"
                }, 
                "description": {
                    "description": "Popis předmětu smlouvy",
                    "type": ["string", "null"],
                    "validity": "A"
                }, 
                "implementation": {
                    "description": "Objekt reprezentující transakce a milníky (odpovídá ODCschema, viz. http://ocds.open-contracting.org/standard/r/1__0__RC/release-schema.json)",
                    "$ref": "#/definitions/Implementation",
                    "validity": "A"
                }
            },
            "patternProperties": {
            },
            "required": ["ammount", "title", "contractType", "publisher", "parties"] 
        },   
        
        "Attachment": {
            "type": "object",
            "title": "Attachment",
            "description": "Popisné údaje přílohy.",
            "properties": {          
                "title": {
                    "description": "Název",
                    "type": ["string", "null"],
                    "validity": "C"
                },
                "contract": {
                    "description": "Jednoznační identifikátor smlouvy",
                    "type": ["string", "null"],
                    "format": "uri",
                    "validity": "C"
                },
                "number": {
                    "description": "Číslo přílohy",
                    "type": ["integer", "null"],
                    "validity": "B"
                }              
            },
            "patternProperties": {
            },
            "required": ["title", "contract"]
        },  
        
        "Amendment": {
            "type": "object",
            "title": "Amendment",
            "description": "Popisné údaje dodatku.",
            "properties": {      
                "title": {
                    "description": "Název",
                    "type": ["string", "null"],
                    "validity": "C"
                },    
                "contract": {
                    "description": "Jednoznační identifikátor smlouvy",
                    "type": ["string", "null"],
                    "format": "uri",
                    "validity": "C"
                },
                "number": {
                    "description": "Číslo dodatku",
                    "type": ["integer", "null"],
                    "validity": "B"
                },  
                "dateSigned": {
                    "description": "Datum podpisu",
                    "type": ["string", "null"],
                    "format": "date",
                    "validity": "B"
                }  
            },
            "patternProperties": {
            },
            "required": ["title", "contract"]
        },     
        
        "Order": {
            "type": "object",
            "title": "Order",
            "description": "",
            "properties": {      
                "parrentDocument": {
                    "description": "Jednoznačný identifikátor smlouvy",
                    "type": ["string", "null"],
                    "format": "uri",
                    "validity": "N"
                },  
                "title": {
                    "description": "Předmět",
                    "type": ["string", "null"],
                    "validity": "C"
                },    
                "ammount": {
                    "description": "Cena s DPH",
                    "type": ["number", "null"],
                    "validity": "C"
                },
                "currency": {
                    "description": "Měna, 3-písmenný, ISO 4217 formát",
                    "type": ["string", "null"],
                    "validity": "B"
                }, 
                "parties": {
                    "description": "Výčet smluvních stran.",
                    "type": "array",
                    "items": { "$ref": "#/definitions/Party" },
                    "validity": "B"
                }, 
                "dateSigned": {
                    "description": "Datum posledního podpisu",
                    "type": ["string", "null"],
                    "format": "date",
                    "validity": "B"
                },  
                "implementation": {
                    "description": "Objekt reprezentující transakce a milníky",
                    "$ref": "#/definitions/Implementation",
                    "validity": "A"
                }      
            },
            "patternProperties": {
            },
            "required": ["title", "ammount"]
        },    
        
        "Invoice": {
            "type": "object",
            "title": "Invoice",
            "description": "Popisné údaje faktury.",
            "properties": {      
                "parrentDocument": {
                    "description": "Jednoznačný identifikátor smlouvy, objednávky",
                    "type": ["string", "null"],
                    "format": "uri",
                    "validity": "N"
                },  
                "title": {
                    "description": "Předmět",
                    "type": ["string", "null"],
                    "validity": "C"
                },    
                "ammount": {
                    "description": "Cena s DPH (u neplátců celková cena). Nejvyšší přípustná hodnota řádného plnění z dané smlouvy, které vynaloží některá smluvní strana. U smluv na dobu určitou se jedná o očekávané celkové finanční plnění strany s nejvyšším plněním, včetně opcí, bez sankcí. U smluv na dobu neurčitou, ve kterých není stanoven strop na celkové plnění, se jedná o nejvyšší očekávané roční plnění. U smluv bez finančního plnění (bartery, darovací smlouvy) je uvedena celková hodnota nefinančního plnění strany s nejvyšším plněním (např. odhadovaná hodnota daru). U smluv s nejasným plněním připustit NULL. Pokud je cena nenulová, tak alespoň jedna Party musí mít příznak Payer = true.",
                    "type": ["number", "null"],
                    "validity": "C"
                },
                "currency": {
                    "description": "Měna, 3-písmenný, ISO 4217 formát",
                    "type": ["string", "null"],
                    "validity": "B"
                }, 
                "due": {
                    "description": "Datum podpisu",
                    "type": ["string", "null"],
                    "format": "date",
                    "validity": "B"
                }, 
                "parties": {
                    "description": "Výčet smluvních stran.",
                    "type": "array",
                    "items": { "$ref": "#/definitions/Party" },
                    "validity": "B"
                }      
            },
            "patternProperties": {
            },
            "required": ["title", "ammount"]
        }     
    }  
}